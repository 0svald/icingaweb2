Alias /icingaweb2 "/usr/share/icingaweb2/public"

<Directory "/usr/share/icingaweb2/public">
    <IfModule !mod_rewrite.c>
        DirectoryIndex error_norewrite.html
        ErrorDocument 404 /error_norewrite.html
    </IfModule>

    <IfModule !mod_proxy_fgci.c>
        DirectoryIndex error_noproxyfcgi.html
        ErrorDocument 404 /error_noproxyfcgi.html
    </IfModule>

    Options SymLinksIfOwnerMatch
    AllowOverride None

    <IfModule mod_authz_core.c>
        # Apache 2.4
        <RequireAll>
            Require all granted
        </RequireAll>
    </IfModule>

    <IfModule !mod_authz_core.c>
        # Apache 2.2
        Order allow,deny
        Allow from all
    </IfModule>

    SetEnv ICINGAWEB_CONFIGDIR "/etc/icingaweb2"

    EnableSendfile Off

    RewriteEngine on
    RewriteBase /icingaweb2/
    RewriteCond %{REQUEST_FILENAME} -s [OR]
    RewriteCond %{REQUEST_FILENAME} -l [OR]
    RewriteCond %{REQUEST_FILENAME} -d
    RewriteRule ^.*$ - [NC,L]
    RewriteRule ^.*$ index.php [NC,L]
    DirectoryIndex index.php

    <FilesMatch \.php$>
        SetHandler "proxy:unix:/run/php-fpm/icingaweb2.sock|fcgi://localhost/"
    </FilesMatch>
</Directory>
