<?php

$servicegroupLinkList = array();
if (!empty($this->servicegroups)) {
    foreach ($this->servicegroups as $name => $alias) {
        $servicegroupLinkList[] = '<a href="' . $this->href(
            'monitoring/list/services',
            array(
                'servicegroups' => $name
            )
        ) . '">' . $alias . '</a>';
    }
}
?>
<?=
$this->partial(
    'show/header.phtml',
    array(
        'host'    => $this->host,
        'service' => $this->service,
        'tabs'    => $this->tabs,
        'compact' => $this->compact
    )
);
?>

<?= $this->preview_image ?>
<div class="panel panel-default">
  <div class="panel-heading">
    <span>Plugin output</span>
  </div>
  <div class="panel-body">
    <?= $this->pluginOutput($this->service->service_output); ?>
    <?= $this->pluginOutput($this->service->service_long_output); ?>
  </div>
</div>

<div class="panel panel-default">
  <div class="panel-heading">
    {{CHECK_ICON}} <span>Check Command</span>
  </div>

  <div class="panel-body">
    <?php
    $explodedCommand = explode('!', $this->service->service_check_command, 2);
    echo array_shift($explodedCommand);
    ?>
    <?= $this->commandArguments($this->service->service_check_command); ?>
  </div>
</div>

<div class="panel panel-default">
  <div class="panel-heading">
    {{GROUP_ICON}} <span>Groups and Contacts</span>
  </div>
  <div  class="panel-body">
  <?php if (count($servicegroupLinkList)) { ?>
    {{SERVICEGROUP_ICON}} <strong>Servicegroups:</strong>
  <?= implode(' ', $servicegroupLinkList); ?>
  <?php } ?>

  <?= $this->render('show/components/contacts.phtml') ?>
  </div>
</div>

<?= $this->render('show/components/comments.phtml'); ?>

<?= $this->render('show/components/downtime.phtml'); ?>

<?= $this->render('show/components/customvars.phtml'); ?>

<?php if ($this->service->service_perfdata): ?>
<div class="panel panel-default">
  <div class="panel-heading">
    <span>Perfdata</span>
  </div>
  <div class="panel-body">
    <?= $this->perfdata($this->service->service_perfdata); ?>
  </div>
</div>
<?php endif; ?>

<div class="panel panel-default">
  <div class="panel-heading">
    <span>Flags</span>
  </div>
  <div class="panel-body">
    <?= $this->render('show/components/flags.phtml'); ?>
  </div>
</div>

<div class="panel panel-default">
  <div class="panel-heading">
    <span>Properties</span>
  </div>
  <div class="panel-body">
    <?= $this->render('show/components/properties.phtml'); ?>
  </div>
</div>

<div class="panel panel-default">
  <div class="panel-heading">
    {{COMMAND_ICON}} <span>Commands</span>
  </div>
  <div class="panel-body">
    <?= $this->monitoringCommands($this->service, 'full'); ?>
  </div>
</div>