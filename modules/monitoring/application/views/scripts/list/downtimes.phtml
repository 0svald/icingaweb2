<?php
$helper = $this->getHelper('CommandForm');
?>
<div class="controls">
<?= $this->tabs ?>
<div style="margin: 1em">
<?=  $this->sortControl->render($this); ?>
</div>
<?=  $this->paginationControl($downtimes, null, null, array('preserve' => $this->preserve)); ?>
</div>

<div class="content downtimes">
<table class="action">
<tbody>
<?php foreach ($this->downtimes as $downtime): ?>
<tr>
  <td>
    <?= $this->dateFormat()->formatDateTime($downtime->start); ?> -
    <?= $this->dateFormat()->formatDateTime($downtime->end); ?>
    <br />
    <small>Duration: <?= $this->util()->showHourMin($downtime->duration); ?></small>
    <br />
    <small>The <?php if($downtime->is_flexible): ?>flexible<?php else: ?>fixed<?php endif; ?> downtime is <?php if(!$downtime->is_in_effect): ?>not <?php endif; ?>in effect</small>
  </td>
  <td>
    <?php if (isset($downtime->service)): ?>
      <a href="<?= $this->href('monitoring/show/service', array(
        'host'    => (string) $downtime->host,
        'service' => (string) $downtime->service
      )); ?>"><?= $downtime->service ?></a>
      <small>on <?= $downtime->host ?></small>
    <?php else: ?>
      <a href="<?= $this->href('monitoring/show/host', array(
        'host'    => (string) $downtime->host
      )); ?>"><?= $downtime->host ?> </a>
    <?php endif; ?>
    <br />
    <?= $downtime->author ?>: <?= $downtime->comment ?>
    <br />
    <small>Entry Time: <?= ($downtime->entry_time) ? $this->dateFormat()->formatDateTime((int) $downtime->entry_time) : ''; ?>
    </small>
  <td style="width: 2em">
      <?php
        $data = array(
          'downtimeid'    => $downtime->id,
          'host'          => $downtime->host
        );
        if (isset($downtime->service)) {
          $data['service'] = $downtime->service;
        }
        echo $helper->iconSubmitForm(
          'img/icons/remove.png',
          'Remove Downtime',
          'link-like',
          'removedowntime',
          $data
        );
      ?>
  </td>
</tr>
<?php endforeach ?>
</tbody>
</table>
</div>
