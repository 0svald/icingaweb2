<?php
$viewHelper = $this->getHelper('MonitoringState');
$knownGroups = array()
?>

<div class="row">
  <div class="pull-left">
    <h1>Contact Groups</h1>
  </div>
  <div class="pull-right">
    <?= $this->tabs->render($this); ?>
  </div>
</div>

<div data-icinga-component="app/mainDetailGrid" data-icinga-grid-selection-type="none">
    <?= $this->sortControl->render($this); ?>
    <?= $this->paginationControl($contactgroups, null, null, array('preserve' => $this->preserve)); ?>
    <table class="table table-condensed">
        <thead>
            <tr>
                <th> Group Name </th>
                <th> Description </th>
                <th> Member Name </th>
            </tr>
        </thead>
        <tbody>


          <?php foreach($contactgroups as $contact): ?>
                <?php $periodLink = $this->href('monitoring/show/contacts', array('contact' => $contact->contact_name)); ?>
                <tr>
                    <?php
                        $groupName = $contact->contactgroup_name;
                        if (!array_key_exists($groupName, $knownGroups)) {
                            echo '<td>' . $groupName . '</td><td>' . $contact->contactgroup_alias . '</td>';
                            $knownGroups[$groupName] = True;
                        } else {
                            echo '<td></td><td></td>';
                        }
                    ?>
                    <td>
                        <a href="<?= $periodLink ?>">
                            <?= $contact->contact_name ?>
                        </a>
                    </td>
                </tr>
            <?php endforeach; ?>
        </tbody>
    </table>
    <?= $this->paginationControl($contactgroups, null, null, array('preserve' => $this->preserve)); ?>
</div>
