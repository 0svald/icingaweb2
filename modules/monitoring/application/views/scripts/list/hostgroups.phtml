<div class="controls">
<?= $this->tabs ?>
<?=  $this->paginationControl($hostgroups, null, null, array('preserve' => $this->preserve)); ?>
<table class="action wide">
<thead>
  <tr>
    <th style="width: 40%; padding-left: 1em;">Hosts</th>
    <th style="width: 60%; padding-left: 1em;">Services</th>
  </tr>
</thead>
</table>
</div>

<table class="action wide">
<tbody>
<?php foreach($hostgroups as $h): ?>
  <tr>
    <td style="width: 40%" class="summary">
      <a href="<?= $this->href(
      'monitoring/list/services',
      array('hostgroup' => $h->hostgroup))
      ?>"><?= $h->hostgroup; ?></a>

<?php if ($h->hosts_up): ?>
      <!-- Hosts UP -->
      <span class="state up">
        <a href="<?= $this->href(
          'monitoring/list/hosts',
          array('host_state' => 0, 'hostgroup' => $h->hostgroup)
        ) ?>" title="Hosts Up"><?= $h->hosts_up ?> Hosts UP</a>
      </span>
      <!-- End of hosts UP -->
<?php endif ?>

<?php if ($h->hosts_down): ?>
      <!-- Hosts DOWN -->
      <span class="state down">
        <a href="<?= $this->href(
          'monitoring/list/hosts',
          array('host_state' => 1, 'hostgroup' => $h->hostgroup)
        ) ?>" title="Hosts Up"><?= $h->hosts_down ?> Hosts DOWN: </a>
<?php if ($h->hosts_down_unhandled): ?>
        <a href="<?= $this->href(
          'monitoring/list/hosts',
          array(
            'host_state'     => 1,
            'host_unhandled' => 1,
            'hostgroup'      => $h->hostgroup
          )
        ) ?>" title="Hosts Down Unhandled"><?= $h->hosts_down_unhandled ?> Unhandled</a>
<?php endif ?>
       </span>
<?php if ($h->hosts_down_handled): ?>
      <span class="state down handled">
        <a href="<?= $this->href(
          'monitoring/list/hosts',
          array(
            'host_state' => 1,
            'host_handled' => 1,
            'hostgroup' => $h->hostgroup
          )
        ) ?>" title="Hosts Down Handled"><?= $h->hosts_down_handled ?></a>
      </span>
<?php endif ?>
      <!-- End of hosts DOWN -->
<?php endif ?>

<?php if ($h->hosts_pending): ?>
      <!-- Hosts PENDING -->
      <span class="state pending">
          <a href="<?= $this->href(
            'monitoring/list/hosts',
            array('host_state' => 99)
          ) ?>" title="Hosts Pending"><?= $h->hosts_pending ?> pending</a>
      </span>
      <!-- End of hosts PENDING -->
<?php endif ?>
    </td>
    <td style="width: 60%" class="summary">
<?php if ($h->services_ok): ?>
      <!-- Services OK -->
      <span class="state ok">
          <a href="<?= $this->href(
            'monitoring/list/services',
            array(
              'service_state' => 0,
              'hostgroup' => $h->hostgroup)
            ) ?>" title="Services Ok"><?= $h->services_ok ?> OK</a>
      </span>
      <!-- End of services OK -->
<?php endif ?>

<?php if ($h->services_critical): ?>
      <!-- Services CRITICAL -->
      <span class="state critical">
        <a href="<?= $this->href(
          'monitoring/list/services',
          array(
            'service_state' => 2,
            'hostgroup' => $h->hostgroup
        )) ?>" title="Services Critical"><?= $h->services_critical ?> CRITICAL: </a>

<?php if ($h->services_critical_unhandled): ?>
        <a href="<?= $this->href(
          'monitoring/list/services',
          array(
            'service_state' => 2,
            'service_unhandled' => 1,
            'hostgroup' => $h->hostgroup
          )
        ) ?>" title="Services Critical Unhandled"><?= $h->services_critical_unhandled ?> Unhandled</a>
<?php endif ?>
<?php if ($h->services_critical_handled): ?>
      <span class="state critical handled">
        <a href="<?= $this->href('monitoring/list/services', array('service_state' => 2, 'service_handled' => 1, 'hostgroup' => $h->hostgroup)); ?>" title="Services Critical Handled">
          <?= $h->services_critical_handled ?> Handled
        </a>
      </span>
<?php endif ?>
      </span>
      <!-- End of services CRITICAL -->
<?php endif ?>

<?php if ($h->services_warning): ?>
      <!-- Services WARNING -->
      <span class="state warning">
        <a href="<?= $this->href('monitoring/list/services', array('service_state' => 1, 'hostgroup' => $h->hostgroup)); ?>" title="Services Warning">
            <?= $h->services_warning ?> WARNING: </a>

<?php if ($h->services_warning_unhandled): ?>
        <a href="<?= $this->href('monitoring/list/services', array('service_state' => 1, 'service_unhandled' => 1, 'hostgroup' => $h->hostgroup)); ?>" title="Services Warning Unhandled">
            <?= $h->services_warning_unhandled ?> Unhandled</a>
<?php endif ?>
<?php if ($h->services_warning_handled): ?>
      <span class="state warning handled">
        <a href="<?= $this->href('monitoring/list/services', array('service_state' => 1, 'service_handled' => 1, 'hostgroup' => $h->hostgroup)); ?>" title="Services Warning Handled">
          <?= $h->services_warning_handled ?> Handled
        </a>
      </span>
<?php endif ?>
      </span>
      <!-- End of WARNING services -->
<?php endif ?>


<?php if ($h->services_unknown): ?>
      <!-- Services UNKNOWN -->
      <span class="state unknown">
        <a href="<?= $this->href(
          'monitoring/list/services',
          array('service_state' => 3, 'hostgroup' => $h->hostgroup)
        ) ?>" title="Services Unknown"><?= $h->services_unknown ?> UNKNOWN: </a>
<?php if ($h->services_unknown_unhandled): ?>
        <a href="<?= $this->href('monitoring/list/services', array('service_state' => 3, 'service_unhandled' => 1, 'hostgroup' => $h->hostgroup)); ?>" title="Services Unknown Unhandled">
            <?= $h->services_unknown_unhandled ?> Unhandled</a>
<?php endif ?>
<?php if ($h->services_unknown_handled): ?>
        <span class="state unknown handled">
          <a href="<?= $this->href(
            'monitoring/list/services',
            array(
              'service_state' => 3,
              'service_handled' => 1,
              'hostgroup' => $h->hostgroup
            )
          ) ?>" title="Services Unknown Handled"><?= $h->services_unknown_handled ?> Handled</a>
        </span>
<?php endif ?>
      </span>
      <!-- End of UNKNOWN services -->
<?php endif ?>

<?php if ($h->services_pending): ?>
      <span class="state pending">
          <a href="<?= $this->href(
            'monitoring/list/services',
            array('service_state' => 99, 'hostgroup' => $h->hostgroup)
          ) ?>" title="Services Pending"><?= $h->services_pending ?></a>
      </span>
<?php endif ?>
    </td>
</tr>
<?php endforeach; ?>
  </tbody>
</table>
