<?php if (! $this->compact): ?>
<div class="controls">
  <?= $this->tabs ?>
  <?= $this->sortBox ?>
  <?= $this->limiter ?>
  <?= $this->paginator ?>
  <?= $this->filterEditor ?>
</div>
<?php endif ?>
<div class="content">
<?php if ($servicegroups->hasResult()): ?>
  <p><?= $this->translate('No servicegroups found matching the filter') ?></p>
</div>
<?php endif ?>
<table class="groupview action" data-base-target="_next">
  <thead>
  <th><?= $this->translate('Service Group') ?></th>
  <th><?= $this->translate('Total Services') ?></th>
  <th><?= $this->translate('Service States') ?></th>
  </thead>
  <tbody>
<?php

$servicegroups->peekAhead($this->compact);
foreach ($servicegroups as  $serviceGroup): ?>
      <tr href="<?= $this->href('monitoring/list/services', array('servicegroup_name' =>  $serviceGroup->servicegroup_name)) ?>">
        <td class="groupname">
          <?= $this->qlink(
             $serviceGroup->servicegroup_alias,
            'monitoring/list/services',
            array('servicegroup_name' =>  $serviceGroup->servicegroup_name),
            array('title' => sprintf($this->translate('List all services in the group "%s"'),  $serviceGroup->servicegroup_alias))
          ) ?>
        </td>
        <td class="total">
          <?=  $serviceGroup->services_total ?>
        </td>
        <td>
        <?php if ( $serviceGroup->services_ok): ?>
          <span class="state ok">
            <?= $this->qlink(
               $serviceGroup->services_ok,
              'monitoring/list/services',
              array(
                'service_state'     => 0,
                'servicegroup_name' =>  $serviceGroup->servicegroup_name,
                'sort'              => 'service_severity'
              ),
              array(
                'title' => sprintf(
                  $this->translatePlural(
                    'List %s service that is currently in state OK in service group "%s"',
                    'List %s services which are currently in state OK in service group "%s"',
                     $serviceGroup->services_ok
                  ),
                   $serviceGroup->services_ok,
                   $serviceGroup->servicegroup_alias
                )
              )
            ) ?>
          </span>
        <?php endif ?>
        <?php if ( $serviceGroup->services_critical_unhandled): ?>
          <span class="state critical">
            <?= $this->qlink(
               $serviceGroup->services_critical_unhandled,
              'monitoring/list/services',
              array(
                'service_state'         => 2,
                'service_acknowledged'  => 0,
                'service_in_downtime'   => 0,
                'host_problem'          => 0,
                'servicegroup_name'     =>  $serviceGroup->servicegroup_name,
                'sort'                  => 'service_severity'
              ),
              array(
                  'title' => sprintf(
                  $this->translatePlural(
                    'List %s service that is currently in state CRITICAL in service group "%s"',
                    'List %s services which are currently in state CRITICAL in service group "%s"',
                     $serviceGroup->services_critical_unhandled
                  ),
                   $serviceGroup->services_critical_unhandled,
                   $serviceGroup->servicegroup_alias
                )
              )
            ) ?>
        <?php endif ?>
          <?php if ( $serviceGroup->services_critical_handled): ?>
            <span class="state critical handled">
              <?= $this->qlink(
                 $serviceGroup->services_critical_handled,
                'monitoring/list/services',
                array(
                  'service_state'     => 2,
                  'service_handled'   => 1,
                  'servicegroup_name' =>  $serviceGroup->servicegroup_name,
                  'sort'              => 'service_severity'
                ),
                array(
                  'title' => sprintf(
                    $this->translatePlural(
                      'List %s service that is currently in state CRITICAL (Acknowledged) in service group "%s"',
                      'List %s services which are currently in state CRITICAL (Acknowledged) in service group "%s"',
                       $serviceGroup->services_critical_handled
                    ),
                     $serviceGroup->services_critical_handled,
                     $serviceGroup->servicegroup_alias
                  )
                )
              ) ?>
            </span>
          <?php endif ?>
        <?php if ( $serviceGroup->services_critical_unhandled): ?>
          </span>
        <?php endif ?>
        <?php if ( $serviceGroup->services_unknown_unhandled): ?>
          <span class="state unknown">
            <?= $this->qlink(
               $serviceGroup->services_unknown_unhandled,
              'monitoring/list/services',
              array(
                'service_state'         => 3,
                'service_acknowledged'  => 0,
                'service_in_downtime'   => 0,
                'host_problem'          => 0,
                'servicegroup_name'     =>  $serviceGroup->servicegroup_name,
                'sort'                  => 'service_severity'
              ),
              array(
                'title' => sprintf(
                  $this->translatePlural(
                    'List %s service that is currently in state UNKNOWN in service group "%s"',
                    'List %s services which are currently in state UNKNOWN in service group "%s"',
                     $serviceGroup->services_unknown_unhandled
                  ),
                   $serviceGroup->services_unknown_unhandled,
                   $serviceGroup->servicegroup_alias
                )
              )
            ) ?>
        <?php endif ?>
          <?php if ( $serviceGroup->services_unknown_handled): ?>
            <span class="state unknown handled">
              <?= $this->qlink(
                 $serviceGroup->services_unknown_handled,
                'monitoring/list/services',
                array(
                  'service_state'     => 3,
                  'service_handled'   => 1,
                  'servicegroup_name' =>  $serviceGroup->servicegroup_name,
                  'sort'              => 'service_severity'
                ),
                array(
                  'title' => sprintf(
                    $this->translatePlural(
                      'List %s service that is currently in state UNKNOWN (Acknowledged) in service group "%s"',
                      'List %s services which are currently in state UNKNOWN (Acknowledged) in service group "%s"',
                       $serviceGroup->services_unknown_handled
                    ),
                     $serviceGroup->services_unknown_handled,
                     $serviceGroup->servicegroup_alias
                  )
                )
              ) ?>
            </span>
          <?php endif ?>
        <?php if ( $serviceGroup->services_unknown_unhandled): ?>
          </span>
        <?php endif ?>
        <?php if ( $serviceGroup->services_warning_unhandled): ?>
          <span class="state warning">
            <?= $this->qlink(
               $serviceGroup->services_warning_unhandled,
              'monitoring/list/services',
              array(
                'service_state'         => 1,
                'service_acknowledged'  => 0,
                'service_in_downtime'   => 0,
                'host_problem'          => 0,
                'servicegroup_name'     =>  $serviceGroup->servicegroup_name,
                'sort'                  => 'service_severity'
              ),
              array(
                'title' => sprintf(
                  $this->translatePlural(
                    'List %s service that is currently in state WARNING in service group "%s"',
                    'List %s services which are currently in state WARNING in service group "%s"',
                     $serviceGroup->services_warning_unhandled
                  ),
                   $serviceGroup->services_warning_unhandled,
                   $serviceGroup->servicegroup_alias
                )
              )
            ) ?>
        <?php endif ?>
          <?php if ( $serviceGroup->services_warning_handled): ?>
            <span class="state warning handled">
              <?= $this->qlink(
                 $serviceGroup->services_warning_handled,
                'monitoring/list/services',
                array(
                    'service_state'     => 1,
                    'service_handled'   => 1,
                    'servicegroup_name' =>  $serviceGroup->servicegroup_name,
                    'sort'              => 'service_severity'
                ),
                array(
                  'title' => sprintf(
                    $this->translatePlural(
                      'List %s service that is currently in state WARNING (Acknowledged) in service group "%s"',
                      'List %s services which are currently in state WARNING (Acknowledged) in service group "%s"',
                       $serviceGroup->services_warning_handled
                    ),
                     $serviceGroup->services_warning_handled,
                     $serviceGroup->servicegroup_alias
                  )
                )
              ) ?>
            </span>
          <?php endif ?>
        <?php if ( $serviceGroup->services_warning_unhandled): ?>
          </span>
        <?php endif ?>
        <?php if ( $serviceGroup->services_pending): ?>
          <span class="state pending">
            <?= $this->qlink(
               $serviceGroup->services_pending,
              'monitoring/list/services',
              array(
                'service_state'     => 99,
                'servicegroup_name' =>  $serviceGroup->servicegroup_name,
                'sort'              => 'service_severity'
              ),
              array(
                'title' => sprintf(
                  $this->translatePlural(
                    'List %s service that is currenlty in state PENDING in service group "%s"',
                    'List %s services which are currently in state PENDING in service group "%s"',
                     $serviceGroup->services_pending
                  ),
                   $serviceGroup->services_pending,
                   $serviceGroup->servicegroup_alias
                )
              )
            ) ?>
          </span>
        <?php endif ?>
        </td>
      </tr>
<?php endforeach ?>
    </tbody>
  </table>
<?php if ($servicegroups->hasMore()): ?>
  <?= $this->qlink(
    $this->translate('Show More'),
    $this->url()->without(array('view', 'limit')),
    null,
    array(
      'data-base-target'    => '_next',
      'class'               => 'pull-right show-more'
    )
  ) ?>
<?php endif ?>
</div>
