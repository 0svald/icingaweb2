<?= $this->tabs->render($this); ?>

<form method="get" action="<?= $this->qUrl(
    'monitoring/list/notifications',
    $this->notifications->getAppliedFilter()->toParams()
);
?>">
    Sort by <?= $this->formSelect(
        'sort',
        $this->sort,
        array(
            'class' => 'autosubmit'
        ),
        array(
            'notification_start_time' => 'Time'
        )
    );
?> 
    <input type="search" name="filter" placeholder="Type to filter" />
    <button class="btn btn-small"><i class="icon-refresh"></i></button>
</form>

<?php
$notifications = $this->notifications->paginate();
echo $this->paginationControl($notifications, null, null, array('preserve' => $this->preserve));
?>

<table class="statustable action hosts">
    <thead>
        <tr>
            <th>Host</th>
            <th>Service</th>
            <th>Type</th>
            <th>Time</th>
            <th>Contact</th>
            <th>Notification command</th>
            <th>Information</th>
        </tr>
    </thead>
    <tbody>
<?php foreach ($notifications as $notification): ?>
        <tr>
            <td>
                <?= $notification->host_name ?>
            </td>
            <td>
                <?= empty($notification->service_description) ? 'N/A' : $notification->service_description ?>
            </td>
            <td><?php
                switch ($notification->notification_reason)
                {
                    case 0:
                        echo 'NORMAL';
                        break;
                    case 1:
                        echo 'ACKNOWLEDGEMENT';
                        break;
                    case 2:
                        echo 'FLAPPINGSTART';
                        break;
                    case 3:
                        echo 'FLAPPINGSTOP';
                        break;
                    case 4:
                        echo 'FLAPPINGDISABLED';
                        break;
                    case 5:
                        echo 'DOWNTIMESTART';
                        break;
                    case 6:
                        echo 'DOWNTIMEEND';
                        break;
                    case 7:
                        echo 'DOWNTIMECANCELLED';
                        break;
                    case 8:
                        if (intval($notification->notification_type) === 0) {
                            echo 'CUSTOM(UP)';
                        } else {
                            echo 'CUSTOM(OK)';
                        }
                        break;
                    case 9:
                        echo 'STALKING';
                        break;
                    default:
                        echo 'UNKNOWN';
                }
?>
            </td>
            <td>
                <?= $notification->notification_start_time ?>
            </td>
            <td>
                <?= $notification->notification_contact ?>
            </td>
            <td>
                <?= $notification->notification_command ?>
            </td>
            <td>
                <?= $this->escape(substr(strip_tags($notification->notification_information), 0, 10000)); ?>
            </td>
        </tr>
<?php endforeach; ?>
    </tbody>
</table>